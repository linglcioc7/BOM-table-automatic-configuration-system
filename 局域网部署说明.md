# BOM生成系统 - 局域网部署说明

## 📋 系统概述

BOM生成系统是一个基于Web的配方管理和BOM表格生成系统，支持局域网部署，可为10人左右的团队提供配方管理和BOM生成服务。

## 🚀 快速部署

### 1. 环境要求
- **操作系统**: Windows 10/11 或 Windows Server 2016+
- **Python**: 3.8 或更高版本
- **内存**: 建议4GB以上
- **存储**: 至少1GB可用空间

### 2. 部署步骤

#### 步骤1: 安装Python环境
```bash
# 下载并安装Python 3.8+
# 确保勾选"Add Python to PATH"
```

#### 步骤2: 安装依赖包
```bash
pip install -r requirements.txt
```

#### 步骤3: 配置防火墙
```bash
# 以管理员身份运行
configure_firewall.bat
```

#### 步骤4: 启动系统
```bash
# 方式1: 直接启动
start_production.bat

# 方式2: 安装为系统服务（推荐）
install_service.bat
```

## 🌐 网络配置

### 1. 获取本机IP地址
```bash
# 运行网络检查脚本
check_network.bat

# 或手动查看
ipconfig
```

### 2. 防火墙配置
系统会自动配置Windows防火墙，开放5000端口。

### 3. 访问地址
- **本机访问**: http://localhost:5000
- **局域网访问**: http://[本机IP]:5000

## 👥 用户管理

### 1. 管理员账户
- **用户名**: shwx
- **密码**: shwxjsb
- **权限**: 配方管理、系统配置

### 2. 普通用户
- **权限**: BOM生成、配方查看
- **无需登录**: 可直接使用BOM生成功能

## 📱 功能说明

### 1. BOM生成系统（公开访问）
- **配方选择**: 支持搜索、分类筛选
- **批量生成**: 支持多个配方同时生成
- **Excel导出**: 自动生成标准BOM表格

### 2. 配方管理系统（需要登录）
- **配方管理**: 增删改查、导入导出
- **批量操作**: 支持批量导入、导出、删除
- **分类管理**: 产品类别设置和筛选

## 🔧 系统维护

### 1. 启动/停止服务
```bash
# 启动服务
nssm start "BOM生成系统"

# 停止服务
nssm stop "BOM生成系统"

# 重启服务
nssm restart "BOM生成系统"
```

### 2. 查看服务状态
```bash
# 查看服务状态
sc query "BOM生成系统"

# 查看服务日志
eventvwr.msc
```

### 3. 数据库备份
```bash
# 备份配方数据
# 导出所有配方到Excel，保存为备份文件
```

## 🚨 故障排除

### 1. 无法启动系统
- 检查Python是否正确安装
- 检查依赖包是否完整
- 检查端口5000是否被占用

### 2. 局域网无法访问
- 检查防火墙配置
- 确认本机IP地址
- 测试网络连通性

### 3. 性能问题
- 检查内存使用情况
- 优化数据库查询
- 考虑增加服务器资源

## 📊 性能优化

### 1. 数据库优化
- 定期清理无效数据
- 优化查询语句
- 考虑使用索引

### 2. 系统优化
- 关闭不必要的服务
- 定期重启系统
- 监控系统资源

## 🔒 安全建议

### 1. 网络安全
- 限制访问IP范围
- 使用HTTPS（如需要）
- 定期更新系统补丁

### 2. 数据安全
- 定期备份数据
- 限制管理员权限
- 记录操作日志

## 📞 技术支持

### 1. 常见问题
- 查看系统日志
- 检查网络配置
- 参考故障排除指南

### 2. 联系管理员
- 系统管理员: shwx
- 技术支持: 请联系系统管理员

## 📝 更新日志

### v1.0 (当前版本)
- ✅ 基础配方管理功能
- ✅ BOM生成功能
- ✅ 批量操作支持
- ✅ 局域网部署支持
- ✅ 用户权限管理

---

**注意**: 本系统仅供内部使用，请勿在公网环境部署。
